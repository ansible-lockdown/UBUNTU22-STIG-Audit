## metadata for Audit benchmark
benchmark_version: '2.1.0'
benchmark: UBUNTU22-STIG

# turn the categories on/off
ubtu22stig_cat1: true
ubtu22stig_cat2: true
ubtu22stig_cat3: true

# Some tests may need to scan every filesystem or have an impact on a system
# these may need be scheduled to minimise impact
run_heavy_tests: true
timeout_ms: 120000

# If using the supplied graphical interface
ubtu22stig_gui: false

# system acts or requires router networking options
ubtu22stig_system_is_router: false

# Allow aide check to run - this can be very resource intensive - not good on shared storage multiple hosts
ubtu22stig_allow_aide_check: false

# Cat 1 rules
#### CAT 1
ubtu_22_211015: true
ubtu_22_212010: true
ubtu_22_215030: true
ubtu_22_215035: true
ubtu_22_255010: true
ubtu_22_255015: true
ubtu_22_255025: true
ubtu_22_255040: true
ubtu_22_271030: true
ubtu_22_432015: true  ## Needs work
ubtu_22_611060: true
ubtu_22_611065: true
ubtu_22_612040: true
ubtu_22_671010: true

#### CAT 2
## 2XX – System Configuration
ubtu_22_212015: true
ubtu_22_213015: true
ubtu_22_213020: true
ubtu_22_213025: true
ubtu_22_214015: true
ubtu_22_215010: true
ubtu_22_231010: true
ubtu_22_232010: true
ubtu_22_232015: true
ubtu_22_232020: true
ubtu_22_232025: true
ubtu_22_232026: true
ubtu_22_232027: true
ubtu_22_232030: true
ubtu_22_232035: true
ubtu_22_232040: true
ubtu_22_232045: true
ubtu_22_232050: true
ubtu_22_232055: true
ubtu_22_232060: true
ubtu_22_232065: true
ubtu_22_232070: true
ubtu_22_232075: true
ubtu_22_232080: true
ubtu_22_232085: true
ubtu_22_232090: true
ubtu_22_232095: true
ubtu_22_232100: true
ubtu_22_232105: true
ubtu_22_232110: true
ubtu_22_232115: true
ubtu_22_232120: true
ubtu_22_232125: true
ubtu_22_232130: true
ubtu_22_232135: true
ubtu_22_232140: true
ubtu_22_232145: true
ubtu_22_251010: true
ubtu_22_251015: true
ubtu_22_251020: true
ubtu_22_251025: true
ubtu_22_251030: true
ubtu_22_253010: true
ubtu_22_255020: true
ubtu_22_255030: true
ubtu_22_255035: true
ubtu_22_255045: true
ubtu_22_255050: true
ubtu_22_255055: true
ubtu_22_255060: true
ubtu_22_255065: true
ubtu_22_271010: true
ubtu_22_271015: true
ubtu_22_271020: true
ubtu_22_271025: true
ubtu_22_291010: true
ubtu_22_291015: true
## 4XX – User Configuration
ubtu_22_411010: true
ubtu_22_411015: true
ubtu_22_411025: true
ubtu_22_411030: true
ubtu_22_411035: true
ubtu_22_411040: true
ubtu_22_412025: true
ubtu_22_412030: true
ubtu_22_412035: true
ubtu_22_431010: true
ubtu_22_431015: true
ubtu_22_432010: true
## 6xx - Authentication, Authorization and Accounting
ubtu_22_611010: true
ubtu_22_611015: true
ubtu_22_611020: true
ubtu_22_611025: true
ubtu_22_611030: true
ubtu_22_611035: true
ubtu_22_611040: true
ubtu_22_611045: true
ubtu_22_611055: true
ubtu_22_611070: true
ubtu_22_612010: true
ubtu_22_612015: true
ubtu_22_612020: true
ubtu_22_612025: true
ubtu_22_612030: true
ubtu_22_612035: true
ubtu_22_631010: true
ubtu_22_651010: true
ubtu_22_651015: true
ubtu_22_651020: true
ubtu_22_651025: true
ubtu_22_651030: true
ubtu_22_652010: true
ubtu_22_652015: true
ubtu_22_653010: true
ubtu_22_653015: true
ubtu_22_653030: true
ubtu_22_653045: true
ubtu_22_653050: true
ubtu_22_653055: true
ubtu_22_653060: true
ubtu_22_653065: true
ubtu_22_653070: true
ubtu_22_653075: true
ubtu_22_654010: true
ubtu_22_654015: true
ubtu_22_654020: true
ubtu_22_654025: true
ubtu_22_654030: true
ubtu_22_654035: true
ubtu_22_654040: true
ubtu_22_654045: true
ubtu_22_654050: true
ubtu_22_654055: true
ubtu_22_654060: true
ubtu_22_654065: true
ubtu_22_654070: true
ubtu_22_654075: true
ubtu_22_654080: true
ubtu_22_654085: true
ubtu_22_654090: true
ubtu_22_654095: true
ubtu_22_654100: true
ubtu_22_654105: true
ubtu_22_654110: true
ubtu_22_654115: true
ubtu_22_654120: true
ubtu_22_654125: true
ubtu_22_654130: true
ubtu_22_654135: true
ubtu_22_654140: true
ubtu_22_654145: true
ubtu_22_654150: true
ubtu_22_654155: true
ubtu_22_654160: true
ubtu_22_654165: true
ubtu_22_654170: true
ubtu_22_654175: true
ubtu_22_654180: true
ubtu_22_654185: true
ubtu_22_654190: true
ubtu_22_654195: true
ubtu_22_654200: true
ubtu_22_654205: true
ubtu_22_654210: true
ubtu_22_654215: true
ubtu_22_654220: true
ubtu_22_654225: true
ubtu_22_654230: true
ubtu_22_654235: true

#### CAT 3
ubtu_22_213010: true
ubtu_22_214010: true
ubtu_22_215015: true
ubtu_22_215020: true
ubtu_22_215025: true
ubtu_22_252010: true
ubtu_22_252015: true
ubtu_22_252020: true
ubtu_22_411045: true
ubtu_22_412010: true
ubtu_22_412015: true
ubtu_22_412020: true
ubtu_22_631015: true
ubtu_22_651035: true
ubtu_22_653020: true
ubtu_22_653025: true
ubtu_22_653035: true
ubtu_22_653040: true

####

# Variables

# Bootloader Settings
ubtu22stig_bootloader_password_hash: 'grub.pbkdf2.sha512.changethispassword' ## This needs to be changed

## UID:
MIN_UID: 1000
MAX_UID: 65000

ubtu22stig_logon_banner:
  - You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.
  - By using this IS (which includes any device attached to this IS), you consent to the following conditions
  - -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
  - -At any time, the USG may inspect and seize data stored on this IS.
  - -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.
  - -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
  - -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.

# 215xxx
## Chrony
ubtu22stig_time_synchronization_servers:
- 'tick.usno.navy.mil'
- 'tock.usno.navy.mil'
- 'ntp2.usno.navy.mil'
ubtu22stig_chrony_server_options: "iburst maxpoll 16"  # Max Settings is maxpoll 16

# Filesystem and mount options
ubtu22stig_home_filesystem: /home

## SSHD
ubtu22stig_sshd_config_file: /etc/ssh/sshd_config
ubtu22stig_ssh_required: true
ubtu22stig_sshd_config:
ubtu22stig_sshd_config_banner_file: /etc/issue
ubtu22stig_sshd_config_ciphers: "aes256-ctr,aes256-gcm@openssh.com,aes192-ctr,aes128-ctr,aes128-gcm@openssh.com"
ubtu22stig_sshd_config_macs: "hmac-sha2-512,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha2-256-etm@openssh.com"
ubtu22stig_sshd_config_kex: "ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256"

## 27XXXX GUI Settings
ubtu22stig_dconf_locald_files:
  - /etc/dconf/db/local.d/

ubtu22stig_dconf_db: local.d

### ACCOUNTS and AUTH ###
## PAM and password settings
ubtu22stig_pass:
  max_days: 60

# Path to set for users initialization files e.g. echo $PATH expected results
ubtu22stig_env_path: '$PATH:$HOME/.local/bin:$HOME/bin'

### Aide
ubtu22stig_use_aide: true
ubtu22stig_aide_cron_file: /etc/cron.daily/aide  # NOTE the path may change if not running daily
ubtu22stig_aide_cron:
  day: '*'
  hour: '4'
  minute: '30'
  job: '/usr/sbin/aide --check | /bin/mail -s "$HOSTNAME - Daily aide integrity check run" root@sysname.mil'
  name: 'Aide Job runs Daily at 0430'

### Rsyslog
# Set the following to true if the server accepts incoming syslog data using rsyslog
ubtu22stig_rsyslog_server: false

# Adjust to match remote syslog server configuration
ubtu22stig_remotelog_server:
  server: 10.10.10.10
  port: 9999
  protocol: '@@'

# 611xxx
# ubtu22stig_passwd_hash_algo is the hashing algorithm used - STIG required SHA512 - default is newer yescrypt
ubtu22stig_passwd_hash_algo: sha512 # pragma: allowlist secret

# 653xxx
### AUDITD
ubtu22stig_audit_log_filesystem: /var/log/audit
ubtu22stig_auditd_disk_full_action: HALT  # Can be one of "SYSLOG", "SINGLE", or "HALT"
ubtu22stig_auditd_log_group: root
ubtu22stig_auditd_email_acct: root
ubtu22stig_auditd_space_left: 25%
ubtu22stig_auditd_space_left_action: EMAIL  # Can be set to exec if running script to inform ISSO

# Adjust to match remote syslog server configuration
ubtu22stig_remotelog_server_address: 10.10.10.10

